import{cromaSos,cromaBem,acordes,notasBase,cifradoANotas,notasACifrado}from"./config.js";import{obtenerValoresSeleccionados,mostrarError}from"./ui.js";import{traducirNotas,mostrar}from"./utils.js";import{reproducirArpegioMixto}from"./sound.js";let notasActuales=[];export function generarNombreAcorde(){const{tono:o,alter:r,tipoA:n}=obtenerValoresSeleccionados();return o+(" "!==r?r:"")+(" "!==n?n:"")}export function nombreAcorde(){const{tono:o,alter:r,tipoA:n}=obtenerValoresSeleccionados();let e=generarNombreAcorde(),a=o+("#"===r||"b"===r?r:"");const t=!["m","m7","m7b5","°","m6","m9","m11","m13"].includes(n);let i=t?cromaSos:cromaBem,s=traducirNotas([a])[0],m=i.indexOf(s);if(-1===m){const o=t?cromaBem:cromaSos;if(m=o.indexOf(s),-1===m)return void mostrar("",[]);i=o}const c=acordes[n];if(!c)return void mostrar(`Acorde no definido: ${n}`,[]);let d=c.map(o=>i[(m+o)%12]);notasActuales=d,mostrar(e,d)}export function obtenerNotasActuales(){return notasActuales}export function traducirTonica(o){return o.map(o=>notasACifrado[o]).filter(Boolean)}export function analizarAcorde(o,r,n,e,a){const t=!!a,i=e?cromaBem:cromaSos,s=i.indexOf(o),m=i.indexOf(r),c=i.indexOf(n),d=t?i.indexOf(a):null;if(console.log(o,r,n,a),-1===s||-1===m||-1===c||t&&-1===d)return null;const u=(o,r)=>(r-o+12)%12,l=u(s,m),f=u(s,c),p=t?u(s,d):null;console.log(l,f,p);let A="desconocido",x="?";return t&&null!==p?3===l&&6===f&&10===p?(A="semidisminuido",x="m7♭5"):3===l&&7===f&&10===p?(A="menor séptima",x="m7"):4===l&&7===f&&10===p?(A="séptima dominante",x="7"):4===l&&7===f&&11===p?(A="mayor séptima",x="maj7"):3===l&&7===f&&11===p?(A="menor con séptima mayor",x="mMaj7"):3===l&&6===f&&9===p?(A="disminuido completo",x="°7"):(A="desconocido",x="?",mostrarError("La combinación ingresada no forma un acorde en su inversión fundamental.")):t||(4===l&&7===f?(A="mayor",x=""):3===l&&7===f?(A="menor",x="m"):3===l&&6===f?(A="disminuido",x="°"):4===l&&8===f?(A="aumentado",x="+"):2===l&&7===f?(A="suspendido 2",x="sus2"):5===l&&7===f?(A="suspendido 4",x="sus4"):mostrarError("La combinación ingresada no forma un acorde en su inversión fundamental.")),{tipoLatina:A,tipoAmericana:x,tonicaAmericana:traducirTonica([o])[0]}}