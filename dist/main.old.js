
import { reproducirArpegioMixto } from './sound.js'; let cromaSos = ["do","do♯","re","re♯","mi","fa","fa♯","sol","sol♯","la","la♯","si"]; let cromaBem = ["do","re♭","re","mi♭","mi","fa","sol♭","sol","la♭","la","si♭","si"]; let notasActuales = []; let cifradoANotas = { "C": "do", "C#": "do♯", "Db": "re♭", "D": "re", "D#": "re♯", "Eb": "mi♭", "E": "mi", "F": "fa", "F#": "fa♯", "Gb": "sol♭", "G": "sol", "G#": "sol♯", "Ab": "la♭", "A": "la", "A#": "la♯", "Bb": "si♭", "B": "si" } let tono = document.getElementById("tonos"); let alteracion = document.getElementById("alteracion"); let tipo = document.getElementById("alteracionM"); function valorInicial(){ alteracion.value = " "; tipo.value = " "; } const acordes = { " ": [0, 4, 7], "m": [0, 3, 7], "sus2": [0, 2, 7], "sus4": [0, 5, 7], "°": [0, 3, 6], "+": [0, 4, 8], "7": [0, 4, 7, 10], "maj7": [0, 4, 7, 11], "m7": [0, 3, 7, 10], "m7b5": [0, 3, 6, 10], "6": [0, 4, 7, 9], "m6": [0, 3, 7, 9], }; function mostrar(Acorde, notasA){ document.getElementById("tonoSelect").innerText = Acorde; document.getElementById("notasSelect").innerText = notasA.join(" - "); } function traducirNotas(cifrado){ return cifrado.map(nota => cifradoANotas[nota]).filter(Boolean); } function filtrarAlteraciones(){ valorInicial(); if (tono.value === "B" || tono.value === "E") { document.getElementById("#").style.display = "none"; document.getElementById("b").style.display = "inline"; }else if (tono.value === "C" || tono.value === "F"){ document.getElementById("#").style.display = "inline"; document.getElementById("b").style.display = "none"; }else{ document.getElementById("#").style.display = "inline"; document.getElementById("b").style.display = "inline"; } } function nombreAcorde(){ let base = tono.value; let alter = alteracion.value; let tipoA = tipo.value; let nombreAcorde = base + alter; if (tipoA !== " "){ nombreAcorde += tipoA; }; let notaOriginal = base + (alter ==="#" ||alter ==="b" ? alter: ""); let notaBase = notaOriginal; const tipoBemol = ["m", "m7", "m7b5", "°", "m6","m9"].includes(tipoA); const usarSostenidos = !tipoBemol; let notasAcorde = usarSostenidos ? cromaSos : cromaBem; let notaTraducida = traducirNotas([notaBase])[0]; let idx = notasAcorde.indexOf(notaTraducida); if (idx === -1) { const otraCromatica = usarSostenidos ? cromaBem : cromaSos; idx = otraCromatica.indexOf(notaTraducida); if (idx !== -1) { notasAcorde = otraCromatica; } else { mostrar("", []); return; } } const intervalos = acordes[tipoA]; if (!intervalos) { mostrar(`Acorde no definido: ${tipoA}`, []); return; } let notas = intervalos.map(i => notasAcorde[(idx + i) % 12]); console.log("notas: "+notas); notasActuales = notas; console.log("Notas actuales:", notas); mostrar(nombreAcorde, notas); reproducirArpegioMixto(notas); } window.addEventListener('DOMContentLoaded', () =>{ valorInicial(); filtrarAlteraciones(); nombreAcorde(); }); document.getElementById("tonos").addEventListener("change", () => { filtrarAlteraciones(); nombreAcorde(); }); document.getElementById("alteracion").addEventListener("change", () => { nombreAcorde(); }); document.getElementById("alteracionM").addEventListener("change", () => { nombreAcorde(); }); document.getElementById('playChordBtn').addEventListener('click', () => { if (notasActuales.length > 0) { reproducirArpegioMixto(notasActuales); } });