
import { actualizarOpciones, verificarNotasValidas, detectarAcorde, obtenerNotasComoArray } from './nombre-acorde.js'; import { reproducirArpegioMixto } from "./sound.js"; import { inicializarMenuHamburguesa } from './menu.js'; import { enviarEventoGA } from './gtag-events.js'; document.addEventListener("DOMContentLoaded", () => { console.log("PÃ¡gina cargada: inicializando eventos"); actualizarOpciones(); document.getElementById("usarSeptima").addEventListener("change", (e) => { actualizarOpciones(); enviarEventoGA("toggle_septima", "interaccion_usuario", null, null, { estado: e.target.checked ? "activada" : "desactivada" }); }); ["notaUno", "notaDos", "notaTres", "usarBemoles"].forEach(id => { document.getElementById(id).addEventListener("change", (e) => { actualizarOpciones(); if (id !== "usarBemoles") { registrarNota(id, e.target.value); } else { enviarEventoGA("toggle_bemoles", "interaccion_usuario", null, null, { estado: e.target.checked ? "activado" : "desactivado" }); } }); }); document.getElementById("notaCuatro")?.addEventListener("change", (e) => { registrarNota("notaCuatro", e.target.value); }); document.getElementById("detectarAcorde").addEventListener("click", () => { detectarAcorde(); const notas = obtenerNotasComoArray(); if (notas.length > 0) { enviarEventoGA("detectar_acorde", "interaccion_usuario", notas.join(', '), notas.length, { incluye_septima: document.getElementById("usarSeptima").checked }); } }); const playBtn = document.getElementById("reproducirNotas"); let reproduciendo = false; playBtn.addEventListener("click", () => { if (reproduciendo) return; const notas = obtenerNotasComoArray(); if (notas.length > 0) { reproduciendo = true; playBtn.disabled = true; reproducirArpegioMixto(notas); enviarEventoGA("reproducir_acorde", "interaccion_usuario", notas.join(', '), notas.length, { incluye_septima: document.getElementById("usarSeptima").checked }); } setTimeout(() => { reproduciendo = false; playBtn.disabled = false; }, 3100); }); verificarNotasValidas(); }); const contadorNotas = { notaUno: {}, notaDos: {}, notaTres: {}, notaCuatro: {} }; function registrarNota(campo, nota) { if (!contadorNotas[campo][nota]) { contadorNotas[campo][nota] = 0; } contadorNotas[campo][nota]++; enviarEventoGA("seleccion_nota", "interaccion_usuario", nota, null, { campo: campo, total_selecciones: contadorNotas[campo][nota] }); }